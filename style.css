/* Cute Theme Styles */
:root{
  --pink:#ff87b7;
  --pink-2:#ffa6c9;
  --hot:#ff4f8b;
  --bg:#fff6fb;
  --card:#ffffff;
  --text:#4b2b3d;
  --muted:#7a5768;
  --shadow: 0 10px 30px rgba(255,79,139,.25);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:'Quicksand', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color:var(--text);
  background: radial-gradient(1200px 800px at 20% -10%, #ffe3f0, transparent),
              radial-gradient(1000px 600px at 120% 10%, #ffe3f0, transparent),
              var(--bg);
}

.container{width:min(1000px,92%);margin-inline:auto}
.site-header,.site-footer{position:relative;z-index:2}
.site-header{padding:20px 0; display:flex; align-items:center}
.logo{font-family:'Baloo 2', cursive; margin:0; font-size:28px}
.music-toggle{margin-left:8px; appearance:none; border:none; background:#fff; color:var(--hot); width:36px; height:36px; border-radius:50%; box-shadow:var(--shadow); cursor:pointer}
.music-toggle.active{background:linear-gradient(135deg,var(--pink),var(--hot)); color:#fff}
.site-footer{padding:26px 0; text-align:center; color:var(--muted)}

.hero{position:relative;text-align:center;padding:70px 0 40px}
.hero-emoji{width:88px;height:88px;filter:drop-shadow(0 8px 16px rgba(0,0,0,.1));}
.hero .hero-emoji{display:block; margin-inline:auto}
.title{font-family:'Baloo 2', cursive; font-size:42px; margin:16px 0 6px}
.subtitle{margin:6px 0 16px; color:var(--muted)}
.micro-hint{font-size:12px;color:var(--muted)}
/* Minify site text presence per request */
.subtitle,.micro-hint{display:none}

.cta-row{display:inline-flex; gap:14px; position:relative; height:56px}
.btn{
  appearance:none; border:none; padding:14px 22px; border-radius:999px;
  cursor:pointer; font-weight:700; letter-spacing:.3px; transition:.2s transform, .3s box-shadow, .3s background, .3s color;
  box-shadow:var(--shadow); position:relative; z-index:2
}
.btn.yes{background:linear-gradient(135deg,var(--pink),var(--hot)); color:white}
.btn.yes:hover{transform:translateY(-1px) scale(1.03)}
.btn.no{background:var(--card); color:var(--hot); border:2px solid var(--pink-2)}
.btn.no:active{transform:scale(.96)}
.btn.ghost{background:transparent;border:2px dashed var(--pink);color:var(--hot)}

.celebration{margin:24px auto 40px; background:var(--card); padding:24px; border-radius:20px; box-shadow:var(--shadow); text-align:center}

.gallery{margin:26px auto 80px}
.gallery h3{font-size:24px;margin:0 0 10px;font-family:'Baloo 2', cursive}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px}
.card{
  background:var(--card); border-radius:16px; overflow:hidden; box-shadow:var(--shadow);
  position:relative; aspect-ratio:1/1; display:flex; align-items:center; justify-content:center
}
.card img{width:100%;height:100%;object-fit:cover}
.card .caption{position:absolute;left:8px;bottom:8px;background:rgba(255,255,255,.75);backdrop-filter: blur(6px); padding:4px 8px;border-radius:999px;font-size:12px}

/* London banner */
.london-banner{position:relative; padding:40px 0 60px; margin:0 0 10px}
.london-banner .london-title{font-family:'Baloo 2', cursive; text-align:center; margin:0 0 6px}
.london-banner .skyline{
  height:80px; border-radius:14px; margin-top:16px; box-shadow:var(--shadow);
  background:
    linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.85)),
    repeating-linear-gradient(90deg, transparent 0 40px, rgba(0,0,0,.04) 40px 80px),
    linear-gradient(0deg, #d66 0 60%, #f9a 60% 100%);
  position:relative; overflow:hidden;
}
.london-banner .skyline:before{
  content:""; position:absolute; inset:0; opacity:.6;
  background:
    radial-gradient(circle at 10% 70%, #0000 0 30px, rgba(0,0,0,.08) 31px 60px, #0000 61px),
    linear-gradient(0deg, rgba(0,0,0,.15) 0 60%, transparent 60%);
}

/* Mini map of London spots */
.mini-map{position:relative; margin:14px auto 6px; padding:18px 10px 26px; border-radius:14px; background:var(--card); box-shadow:var(--shadow)}
.mini-map .map-rail{position:absolute; left:12px; right:12px; top:50%; height:10px; background:linear-gradient(90deg,#ffe9f3,#fff); border-radius:999px; box-shadow: inset 0 2px 6px rgba(0,0,0,.06)}
.mini-map .progress{position:absolute; left:12px; top:50%; height:10px; width:0; transform:translateY(-50%); background:linear-gradient(90deg,var(--hot),var(--pink)); border-radius:999px; box-shadow:0 2px 10px rgba(255,79,139,.25)}
.mini-map .train{position:absolute; top:50%; left:12px; transform:translate(-50%,-50%); display:flex; gap:4px; height:22px; background:transparent; box-shadow:0 6px 14px rgba(27,108,242,.18)}
.mini-map .train .car{width:28px; height:18px; background:#f2f6ff; border:2px solid #1b6cf2; border-radius:4px; position:relative; overflow:hidden}
.mini-map .train .car:before{content:""; position:absolute; left:3px; right:3px; top:4px; height:7px; background:linear-gradient(90deg,#1b6cf2 0 22%, #bbd0ff 22% 48%, #1b6cf2 48% 70%, #bbd0ff 70% 100%); border-radius:2px}
.mini-map .train .car:after{content:""; position:absolute; left:6px; right:6px; bottom:-5px; height:10px; background:radial-gradient(circle at 0 50%, #333 3px, #0000 4px) 0 0/50% 100% no-repeat, radial-gradient(circle at 100% 50%, #333 3px, #0000 4px) 100% 0/50% 100% no-repeat}
.mini-map .train .engine{border-top-left-radius:10px; border-bottom-left-radius:10px}
.mini-map .train .engine .chimney{position:absolute; width:6px; height:8px; left:-3px; top:-6px; background:#1b6cf2; border-radius:2px}
.mini-map .train.bob{animation:bob 1.2s ease-in-out infinite}
@keyframes bob{0%,100%{transform:translate(-50%,-50%) translateY(0)} 50%{transform:translate(-50%,-50%) translateY(-1px)}}
.mini-map .pin{position:absolute; top:50%; transform:translate(calc(var(--x) - 50%), -50%); left:var(--x); appearance:none; border:none; background:transparent; cursor:pointer}
.mini-map .pin::before{content:""; display:block; width:14px; height:14px; background:var(--hot); transform:rotate(45deg); border-radius:3px 50% 50% 50%; box-shadow:0 6px 14px rgba(255,79,139,.35)}
.mini-map .pin span{position:absolute; top:-28px; left:50%; transform:translateX(-50%); white-space:nowrap; background:#fff; color:var(--text); font-size:12px; padding:3px 6px; border-radius:999px; box-shadow:0 2px 10px rgba(0,0,0,.06)}
.mini-map .pin:focus-visible span{outline:2px solid var(--pink)}
/* Celebrate a stop */
.mini-map .pin.hit::before{animation:pop 420ms ease}
.mini-map .pin.hit span{animation:floatUp 600ms ease}
@keyframes pop{0%{transform:rotate(45deg) scale(1)} 40%{transform:rotate(45deg) scale(1.4)} 100%{transform:rotate(45deg) scale(1)}}

/* Confetti burst */
.mini-map .burst{position:absolute; top:50%; transform:translateY(-50%); pointer-events:none}
.mini-map .piece{position:absolute; width:6px; height:6px; border-radius:50%; opacity:0; animation:burstMove 600ms ease-out forwards}
@keyframes burstMove{0%{transform:translate(0,0) scale(1); opacity:1} 100%{transform:translate(var(--dx), var(--dy)) scale(0.8); opacity:0}}

@media (max-width:700px){
  .mini-map{padding:16px 8px 24px}
  .mini-map .pin span{font-size:11px}
}

/* Stats */
.stats{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:14px; margin:14px auto 24px}
.stat-card{background:var(--card); border-radius:16px; padding:18px; text-align:center; box-shadow:var(--shadow)}
.stat-number{font-family:'Baloo 2', cursive; font-size:40px; color:var(--hot); line-height:1}
.stat-live{margin-top:6px; color:var(--muted); font-size:13px}
.stat-label{color:var(--muted)}

/* Story timeline */
.story{margin:10px auto 28px}
.story h3{font-size:24px;margin:0 0 10px;font-family:'Baloo 2', cursive}
.timeline{list-style:none;padding:0;margin:0;display:grid;gap:10px}
.timeline li{background:var(--card); padding:14px 14px 14px 42px; border-radius:14px; position:relative; box-shadow:var(--shadow)}
.timeline .dot{position:absolute; left:12px; top:12px; width:22px; height:22px; display:grid; place-items:center; background:#fff; border-radius:50%; box-shadow:0 2px 6px rgba(0,0,0,.1)}

/* Coupon */
.coupon{margin:10px auto 30px}
.coupon-card{background:linear-gradient(135deg, #ffe6f2, #fff); border:2px dashed var(--pink); border-radius:16px; padding:18px; text-align:center; box-shadow:var(--shadow)}
.coupon-title{font-family:'Baloo 2', cursive; font-size:22px; margin:0 0 6px}
.coupon-sub{color:var(--muted); margin:0 0 8px}
.coupon-code{font-weight:700; letter-spacing:2px; color:var(--hot); margin:6px 0}
.coupon-note{font-size:12px; color:var(--muted); margin:6px 0 0}

/* Floating hearts background */
#hearts-bg{position:fixed; inset:0; overflow:hidden; pointer-events:none; z-index:0}
.heart{
  position:absolute; width:16px; height:16px; background:var(--hot);
  transform: rotate(-45deg);
  animation: floatUp linear forwards;
  box-shadow: 0 2px 8px rgba(255,79,139,.25);
}
.heart:before,.heart:after{
  content:''; position:absolute; width:16px; height:16px; background:var(--hot);
  border-radius:50%;
}
.heart:before{top:-8px;left:0}
.heart:after{left:8px;top:0}
@keyframes floatUp{to{transform:translateY(-120vh) rotate(-45deg); opacity:0}}

/* Canvas full screen for confetti */
#confettiCanvas{position:fixed; inset:0; pointer-events:none; z-index:3}

/* Make the no button evasive container bigger on small screens */
@media (max-width:600px){
  .cta-row{height:80px}
}

/* ===================== Responsive ===================== */
@media (max-width:900px){
  .title{font-size:36px}
  .hero{padding:56px 0 34px}
  .carousel-stage{height:340px}
  .car-polaroid{width:110px; height:128px}
}

@media (max-width:700px){
  .logo{font-size:24px}
  .music-toggle{width:34px;height:34px}
  .hero-emoji{width:76px;height:76px}
  .title{font-size:30px}
  .cta-row{gap:10px; height:72px}
  .btn{padding:12px 18px}
  /* Make hero fill screen height minus header space with spaced content */
  .hero{min-height:calc(100vh - 120px); display:flex; flex-direction:column; justify-content:space-evenly}
  .carousel-stage{height:300px}
  .car-polaroid{width:100px;height:120px}
  .london-banner .skyline{height:70px}
  .stats{grid-template-columns:repeat(2,1fr)}
  .gate-card{padding:12px}
  .intro-avatar{width:52px;height:52px}
  /* Equal button widths on mobile */
  .btn.yes, .btn.no{width:44vw; max-width:220px}
}

@media (max-width:500px){
  .container{width:min(100%,92%)}
  .title{font-size:26px}
  .hero{padding:48px 0 28px}
  .carousel-stage{height:260px}
  .car-polaroid{width:88px;height:106px}
  .carousel-ctrls{gap:8px}
  .lb-inner{max-width:94vw; max-height:80vh}
  .lb-inner img{max-width:88vw; max-height:64vh}
  .gate-intro{padding:10px}
  .intro-bubble{padding:8px 10px}
  .btn.small{padding:9px 12px; font-size:13px}
  /* Center stats and limit width */
  .stats{grid-template-columns:1fr}
  .stat-card{max-width:280px; margin-inline:auto}
}

/* Storybook (flipbook-style carousel) */
.storybook{margin:20px auto 28px}
.storybook h3{font-size:24px;margin:0 0 12px;font-family:'Baloo 2', cursive;text-align:center}
.book{position:relative; display:flex; align-items:center; gap:10px}
.book .nav{appearance:none; border:none; background:var(--card); color:var(--hot); width:40px; height:40px; border-radius:50%; box-shadow:var(--shadow); font-size:22px; font-weight:700; cursor:pointer}
.book .nav:disabled{opacity:.5; cursor:default}
.pages{position:relative; overflow:hidden; flex:1; border-radius:16px; box-shadow:var(--shadow); background:var(--card)}
.page{min-height:160px; padding:18px; display:none; animation:.35s ease both fadeSlideIn}
.page.active{display:block}
.page h4{margin:0 0 8px; font-family:'Baloo 2', cursive}
.page p{margin:0; color:var(--muted)}
.dots{display:flex; justify-content:center; gap:6px; margin-top:10px}
.dots button{width:8px; height:8px; border-radius:50%; border:none; background:#e9c0d2; cursor:pointer}
.dots button.active{background:var(--hot)}
@keyframes fadeSlideIn{from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:none}}

/* Photo heart section */
.photo-heart{margin:10px auto 34px}
.photo-heart h3{font-size:24px;margin:0 0 10px;font-family:'Baloo 2', cursive}
.heart-stage{background:var(--card); border-radius:16px; box-shadow:var(--shadow); padding:8px;}
.heart-stage canvas{display:block; width:100%; height:auto; border-radius:12px; background:linear-gradient(180deg,#fff,#fff6fb)}

/* Hide basic gallery listing (we now showcase photos via animations) */
.gallery{display:none}

/* Heart-Path Carousel */
.carousel{margin:18px auto 36px}
.carousel h3{font-size:24px;margin:0 0 10px;font-family:'Baloo 2', cursive}
.carousel .subnote{margin: -6px 0 6px; color:var(--muted); font-size:14px; font-weight:600}
.carousel-stage{position:relative; height:380px; border-radius:18px; background:var(--card); box-shadow:var(--shadow); overflow:hidden}
.carousel-track{position:absolute; inset:0}
.carousel-item{position:absolute; left:0; top:0; transform:translate(-50%,-50%) scale(1); transition:transform .25s cubic-bezier(.2,.8,.2,1), filter .25s, opacity .25s; will-change:transform, filter;}
.car-polaroid{position:relative; width:120px; height:140px; border-radius:10px; background:#fff; box-shadow:0 10px 20px rgba(0,0,0,.15); display:grid; place-items:center}
.car-polaroid .img{position:relative; width:92%; height:78%; border-radius:6px; overflow:hidden;}
.car-polaroid .img img{width:100%; height:100%; object-fit:cover; display:block}
.car-polaroid .cap{position:absolute; left:0; right:0; bottom:6px; text-align:center; font-size:12px; color:var(--muted)}
.carousel-item.focus{z-index:4}
.carousel-item.focus .car-polaroid{box-shadow:0 16px 40px rgba(255,79,139,.35)}
.carousel-item .glow{position:absolute; inset:-30px; background:radial-gradient(40% 40% at 50% 50%, rgba(255,135,183,.45), rgba(255,135,183,0)); filter:blur(18px); z-index:-1; opacity:0; transition:opacity .25s}
.carousel-item.focus .glow{opacity:1}
.carousel-item.far{filter:blur(1.2px) saturate(.9); opacity:.9}
.carousel-ctrls{display:flex; gap:10px; justify-content:center; margin-top:10px}

@media (max-width:700px){
  .carousel-stage{height:320px}
  .car-polaroid{width:100px;height:120px}
}

/* Lightbox */
.lightbox{position:fixed; inset:0; background:rgba(20,10,16,.6); backdrop-filter: blur(4px); display:none; align-items:center; justify-content:center; z-index:50}
.lightbox[aria-hidden="false"]{display:flex}
.lb-inner{position:relative; max-width:min(92vw,1000px); max-height:86vh; display:grid; gap:10px; padding:16px; background:linear-gradient(180deg,#fff,#fff6fb); border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,.35)}
.lb-inner img{max-width:80vw; max-height:70vh; border-radius:12px; box-shadow:var(--shadow); object-fit:contain}
.lb-cap{color:var(--muted); text-align:center}
.lb-arrows{position:absolute; inset:0; pointer-events:none}
.lb-arrow{position:absolute; top:50%; transform:translateY(-50%); pointer-events:auto; background:rgba(255,255,255,.85); border:none; width:44px; height:44px; border-radius:50%; box-shadow:var(--shadow); cursor:pointer}
#lbPrev{left:-10px}
#lbNext{right:-10px}
.lb-close{position:fixed; top:18px; right:20px; appearance:none; border:none; background:rgba(255,255,255,.95); width:40px; height:40px; border-radius:50%; box-shadow:var(--shadow); cursor:pointer}

/* Gate mini-game */
.gate{position:fixed; inset:0; background:linear-gradient(135deg,#fff5fb,#ffe5f1); display:flex; align-items:center; justify-content:center; z-index:60}
.gate-card{position:relative; width:min(1000px,92vw); max-height:92vh; display:flex; flex-direction:column; background:#fff; border-radius:20px; padding:16px; box-shadow:0 30px 80px rgba(255,79,139,.25); text-align:center; overflow:hidden}
.gate-title{font-family:'Baloo 2', cursive; margin:6px 0 10px}
#gateCanvas{width:100%; height:auto; flex:1 1 auto; border-radius:14px; background:linear-gradient(180deg,#fff,#fff6fb); box-shadow:var(--shadow)}
.gate-ui{position:relative; z-index:1; display:flex; gap:12px; align-items:center; justify-content:center; margin-top:12px}
.gate-status{color:var(--muted)}
body.gated{overflow:hidden}
/* Hide content until Yes is pressed */
.site-locked .post-yes{display:none}

/* Gate intro bottom sheet */
.gate-intro{position:absolute; left:0; right:0; bottom:0; transform:translateY(0); background:rgba(255,255,255,.9); backdrop-filter: blur(6px); border-top-left-radius:18px; border-top-right-radius:18px; box-shadow:0 -12px 30px rgba(0,0,0,.08); padding:12px; z-index:5}
.intro-content{display:flex; align-items:flex-end; gap:12px; max-width:min(900px,92vw); margin:0 auto}
.intro-avatar{width:60px; height:60px; border-radius:50%; object-fit:cover; box-shadow:var(--shadow)}
.intro-bubble{flex:1; background:#fff; border-radius:14px; padding:10px 12px; box-shadow:var(--shadow); position:relative}
.intro-title{margin:0 0 4px; font-weight:700}
.intro-text{margin:0 0 8px}
.btn.small{padding:10px 14px; font-size:14px}

/* Song prompt modal */
.song-prompt{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:65; background:rgba(0,0,0,.35); backdrop-filter: blur(2px)}
.song-prompt[aria-hidden="false"], .song-prompt.show{display:flex}
.prompt-card{background:#fff; border-radius:16px; padding:16px; box-shadow:0 20px 60px rgba(0,0,0,.25); width:min(92vw,520px); text-align:center}
.prompt-text{margin:4px 0 12px; color:var(--text)}
.prompt-actions{display:flex; gap:12px; justify-content:center}
